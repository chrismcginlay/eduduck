#core/middleware.py

class TimezoneMiddleware(object):

    def process_request(self, request):
        try:
            tz = request.user.bio.user_tz
            timezone.activate(tz)
        except:
            logger.warning("Reverting to default timezone UTC")
            timezone.activate(timezone.utc)
    return None
            
